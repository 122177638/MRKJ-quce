<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="ie=edge,chrome=1">
    <meta name="viewport" content="width=device-width,initial-scale=1.0, user-scalable=0, minimum-scale=1.0, maximum-scale=1.0">
    <meta name="apple-touch-fullscreen" content="yes">
    <meta name="format-detection" content="telephone=no">
    <!-- 去除浏览器地址栏和菜单栏 -->
    <meta name='apple-mobile-web-app-capable' content='yes' />
    <meta name='full-screen' content='true' />
    <meta name='x5-fullscreen' content='true' />
    <meta name='360-fullscreen' content='true' />
    <title>财商测试</title>
    <!--[if lt IE 9]>  
        <script src="http://cdn.bootcss.com/html5shiv/r29/html5.js"></script>
        <script src="https://cdn.bootcss.com/respond.__PUBLIC__/js/1.4.2/respond.min.js"></script>    
    <![endif]-->
    <link rel="stylesheet" href="__PUBLIC__/css/public_zm.css">
    <link rel="stylesheet" href="__PUBLIC__/css/_cspay.css">
    <script src="__PUBLIC__/js/rem.js"></script>
    <script src="__PUBLIC__/js/jquery.min.js"></script>
    <style>
         /*pay confrim box*/
         .ConfirmPaybox {
            position: fixed;
            width: 100%;
            height: 100%;
            left: 0;
            top: 0;
            z-index: 10;
            display: none;
        }
        .ConfirmPaybg {
            display: block;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.4);
        }
        .ConfirmPayInfo {
            display: block;
            position: absolute;
            width: 100%;
            left: 0;
            bottom: 0;
            background-color: white;
            transform:translateY(217px);
            -webkit-transform:translateY(217px);
            -moz-transform:translateY(217px);
            -ms-transform:translateY(217px);
            -o-transform:translateY(217px);
        }
        .ConfirmPay-titlebox {
            -webkit-box-sizing: border-box;
            box-sizing: border-box;
            padding: 0 0.2rem;
        }
        .ConfirmPay-title {
            text-align: left;
            color: #444444;
            font-weight: 900;
            margin: 0.41rem 0 0.31rem 0;
            font-size: 0.36rem;
            line-height: 0.36rem;
        }
        .ConfirmPay-list {
            font-size: 0.28rem !important;
            text-align: left;
            margin-bottom: 0.51rem;
            line-height: 0.28rem;
        }
        .ConfirmPay-list a {
            color: #808080;
            text-decoration: none;
            -webkit-tap-highlight-color: transparent;
        }
        .ConfirmPay-list span {
            color: #9596ab;
            text-decoration: underline;
        }
        .ConfirmPay-spliteline {
            display: block;
            height: 1px;
            background-color: #EEEEEE;
        }
        .ConfirmPay-prizebox {
            overflow: hidden;
            padding: 0 0.2rem;
            line-height: 1.8rem;
        }
        .ConfirmPay-prizetext {
            float: left;
            font-size:0.28rem;
            color: #999999;
        }
        .ConfirmPay-prize {
            float: right;
            font-size: 0.84rem;
            color: #444444;
            font-family: helvetica;
        }
        .ConfirmPaybtnbox {
            -webkit-box-sizing: border-box;
            box-sizing: border-box;
            padding: 0 0.2rem 0.4rem 0.2rem;
        }
        .ConfirmPaybtnbox .ConfirmPaybtn:nth-child(1){margin-bottom:0.3rem;background-color: #00C800;}
        .ConfirmPaybtn{
            background-color: #56AAE6;
            font-size: 0.32rem;
            border-radius: 0.12rem;
            height:1rem;
            line-height: 1rem;
            text-align: center;
            display: block;
            color: white;
            -webkit-border-radius: 0.12rem;
            -moz-border-radius: 0.12rem;
            -ms-border-radius: 0.12rem;
            -o-border-radius: 0.12rem;
            -webkit-tap-highlight-color: transparent;
            text-decoration: none;
        }
        .ConfirmPaybtn::before{
            content:'';
            width:0.64rem;
            height:0.64rem;
            display: inline-block;
            vertical-align: middle;
            margin-right:0.3rem;
        }
        .ConfirmPaybtn:nth-child(1)::before{
            background:url('__PUBLIC__/images/wxzf.png') no-repeat;
            background-size:100% 100%;
        }
        .ConfirmPaybtn:nth-child(2)::before{
            background:url('__PUBLIC__/images/zfbzf.png') no-repeat;
            background-size:100% 100%;
        }
        .showConfirm {
            display: block;
        }
        /* animation */
        .showConfirm .ConfirmPayInfo {
            -webkit-animation:upin 0.3s 0s 1 ease normal forwards;
            animation: upin 0.3s 0s 1 ease normal forwards;
        }
        @keyframes upin {
            100% {
                transform:translateY(0);
                -webkit-transform:translateY(0);
                -moz-transform:translateY(0);
                -ms-transform:translateY(0);
                -o-transform:translateY(0);
            }
        }
    </style>
</head>
<body>
    <!-- header -->
    <include file="Public/public_zm_head"/>
    <div class="public_banner"><img src="__PUBLIC__/images/cstest/banner_zf.png" width="100%" alt=""></div>
    <div class="paypage_content">
        <div class="paypage_box">
            <h3 class="box_title">您的财商分析报告</h3>
            <p class="seeCount"><!--{$csNum}-->人已取得报告</p>
            <ul class="p_list">
                <li>1.内含您财商的整体情况详解，根据您的财商得分，预测您未来可以达到的财富级别。</li>
                <li>2.对比您挣钱以及守钱的能力，让你更了解自己在财富面前的优势与短板，从而规避风险。</li>
                <li>3.各项财商分能力一一对比，财商专家给您最权威的改善建议，轻轻松松发大财。</li>
            </ul>
            <p class="discount">优惠价19元</p>
            <div class="seeBtn J_pay_event">查看自己财商得分和赚钱能力分析报告</div>
            <p class="discountTime">距优惠结束还有：<span class="countTime"></span></p>
        </div>
        <div class="lock_test_box">
            <h3 class="lock_title">你将获得5大财富机密</h3>
            <div class="lock_img_box">
                <img class="J_pay_event" src="__PUBLIC__/images/cstest/01_zf.png" width="100%" alt="">
                <img class="J_pay_event" src="__PUBLIC__/images/cstest/02_zf.png" width="100%" alt="">
                <img class="J_pay_event" src="__PUBLIC__/images/cstest/03_zf.png" width="100%" alt="">
                <img class="J_pay_event" src="__PUBLIC__/images/cstest/04_zf.png" width="100%" alt="">
                <img class="J_pay_event" src="__PUBLIC__/images/cstest/05_zf.png" width="100%" alt="">
            </div>
        </div>
    </div>
    <!-- 支付弹窗 -->
    <div id="ConfirmPaybox" class="ConfirmPaybox">
        <div id="ConfirmPaybg" class="ConfirmPaybg"></div>
        <div class="ConfirmPayInfo">
            <div class="ConfirmPay-titlebox">
                <p class="ConfirmPay-title"><!--{$answer['title']}--></p>
                <p class="ConfirmPay-list"><a href="<!--{:U('Index/mytest','',false)}-->">支付后的测试可在我的&nbsp;<span>我测过的</span>&nbsp;中查看。</a></p>
                <span class="ConfirmPay-spliteline"></span>
            </div>
            <div class="ConfirmPay-prizebox">
                <span class="ConfirmPay-prizetext">支付总额：</span>
                <span class="ConfirmPay-prize">￥<!--{$Think.cookie.price}--></span>
            </div>
            <div class="ConfirmPaybtnbox">
                <if condition="$wxlogin eq 1">
                    <a href="javascript:;" class="ConfirmPaybtn wxzf">微信支付</a>
                    <else />
                    <a class="ConfirmPaybtn" href="<!--{:U('Paycs/paywx','',false)}-->" >微信支付</a>
                    <a class="ConfirmPaybtn" href="<!--{:U('Paycs/payzfb','',false)}-->">支付宝支付</a>
                </if>
            </div>
        </div>
    </div>
    <!-- 返回弹窗 -->
    <div class="back_popup_container">
        <div class="back_popup_bg"></div>
        <div class="back_popup_wrap">
            <div class="back_popup_close"></div>
            <h4 class="back_popup_title">快速获取专业财商测评报告</h4>
            <div class="back_popup_top">
                <img src="__PUBLIC__/images/cstest/zf_bj.png" class="back_popup_banner" alt="">
                <img src="__PUBLIC__/images/cstest/zhun.png" class="back_popup_zhun" alt="">
                <p class="back_popup_top_c">最专业财商报告解读，最权威的专家建议，助你走上财富的康庄大道。</p>
            </div>
            <div class="back_popup_Btn">立即领取</div>
            <p class="back_popup_count"><span><!--{$csNum}-->人</span>已获取</p>
        </div>
    </div>
    <script>
        let URL = window.location.href;
        let totalArr = URL.split('?')[1].split('=')[1];
        $('.J_pay_event').on('click',function(){
            $('#ConfirmPaybox').addClass('showConfirm');
            $.post("<!--{:U('Paycs/jieguoyeJson','',false)}-->",{totalArr},function(data){
                console.log(data)
            })    
        })
        $('.ConfirmPaybg').on('click',function(e){
            $('#ConfirmPaybox').removeClass('showConfirm');
        })
        
        window.history.pushState('',null,'');
        window.addEventListener('popstate',function(e){
            $('.back_popup_container').addClass('show');
        })
        $('.back_popup_close').on('click',function(){
            $('.back_popup_container').removeClass('show');
        })
        $('.wxzf').on('click',function(){
            WeixinJSBridge.invoke(
                'getBrandWCPayRequest', {
                    "appId":"<!--{$appId}-->",     //公众号名称，由商户传入
                    "timeStamp":"<!--{$timeStamp}-->",         //时间戳，自1970年以来的秒数
                    "nonceStr":"<!--{$nonceStr}-->", //随机串
                    "package":"<!--{$package}-->",
                    "signType":"<!--{$signType}-->",         //微信签名方式：
                    "paySign":"<!--{$paySign}-->" //微信签名
                },
                function(res){
                    if(res.err_msg == "get_brand_wcpay_request:ok" ) {
                        location.href="<!--{:U('Paycs/jieguoye','',false)}-->";
                    }     // 使用以上方式判断前端返回,微信团队郑重提示：res.err_msg将在用户支付成功后返回    ok，但并不保证它绝对可靠。
                }
            );
        })
        // 计时
        let setHDTime;
        if(sessionStorage.getItem('countDownTime')){
            setHDTime =  sessionStorage.getItem('countDownTime')
        }else{
            setHDTime =  60*60*24;
        }
        setInter();
        function setInter(){
            setHDTime--;
            let timeArr =  countDown(setHDTime);
            sessionStorage.setItem('countDownTime',setHDTime)
            $('.countTime').text(timeArr[1]+'分'+timeArr[2]+'秒')
            setTimeout(function(){
                setInter();
            },1000)
        }
        function countDown(time){
            // time 单位秒
            let ddNum = Math.floor( time % (24*3600)); 
            let hours = Math.floor(time / (3600));

            let minutesNum = ddNum%(3600);         
            let minutes = Math.floor(minutesNum/(60));

            let secondNum = ddNum%(60)
            let second = Math.floor(secondNum);
            // fillNum
            function fillNum(num){
                if(num > 9){
                    return num;
                }else{
                    return '0'+num;
                }
            }
            return [fillNum(hours),fillNum(minutes),fillNum(second)]
        }
        
        

    </script>
</body>
</html>